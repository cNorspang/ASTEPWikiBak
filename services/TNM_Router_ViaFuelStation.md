---
title: TNM Router ViaFuelStation
description: 
published: true
date: 2021-12-13T07:59:25.990Z
tags: 
editor: markdown
---

# TNM Router ViaFuelStation
The **TNM Router ViaFuelStation** is a router that takes into count, whether the user has fuel enough to drive the route, while routing through fuel stations to enable refueling on the route.

The code is available on [Gitlab](https://daisy-git.cs.aau.dk/astep-2021/tnmrouterviafuelstation2021).

## Content 
- [Input](#input)
- [Output](#output)
- [Endpoints](#endpoints)

## Input
The router expects the following attributes in json.
- **_start_node_** : The ID of the _Node_ where the the route starts.
- **_end_node_**: The ID of the _Node_ where the route ends.
- **_fuel_level_**: The amount of available fuel (in liters).
- **_model_**: A [_Transport network model_](https://wiki.astep-dev.cs.aau.dk/rfc/0020).

### Format
The accepted _JSON_ input format:

```json
[
    {
        "start_node": <int>,
        "end_node": <int>,
        "fuel_level": <float>,
        "model": {
            "meta_data": {
                "max_length": <int>,
                "min_length": <int>,
                "max_slope": <float>,
                "min_slope": <float>,
                "max_set_max_speed": <int>,
                "min_recommended_speed": <int>,
                "max_mean_speed": <float>,
                "min_mean_speed": <float>,
                "max_daily_year": <float>,
                "min_daily_year": <float>,
                "max_daily_july": <float>,
                "min_daily_july": <float>,
                "max_daily_trucks": <float>,
                "min_daily_trucks": <float>
            },
            "vehicle": {
                "id": <int>,
                "name": <string>,
                "data": {
                    "top_speed": <float>,
                    "milage": <float>,
                    "max_fuel": <float>
                }
            },
            "nodes": {
                "<int>": {
                    "id": <int>,
                    "weight": <float>,
                    "data": {
                        "longitude": <float>,
                        "latitude": <float>,
                        "country": <string>,
                        "municipality": <string>,
                        "is_border": <bool>,
                        "type": <string>,
                        "signal_control": <bool>
                    },
                    "edges": {
                        "<int>": {
                            "id": <int>,
                            "to_node_id": <int>,
                            "from_node_id" : <currentNode id>,
                            "weight": <float>,
                            "data": {
                                "length": <int>,
                                "slope": <float>,
                                "type": <string>,
                                "type_max_speed": <int>,
                                "set_max_speed": <int>,
                                "recommended_speed": <int>,
                                "mean_speed": <float>,
                                "daily_year": <float>,
                                "daily_july": <float>,
                                "daily_trucks": <float>,
                                "daily_10_axle": <float>,
                                "fuel_station": <bool>,
                                "max_axle_load": <float>,
                                "max_height": <float>,
                                "max_length": <float>,
                                "max_weight": <float>
                            }
                        }
                    }
                }
            }
        }
    }
]
```

## Output
The router will return a **TNM** containing the route within a json string. Only the edges with fuel stations that should be used, will have the attribute _fuel_station_ set to true, the others will be set to false.

### Format
The generated _JSON_ output generated by the router:
```json
{
    "meta_data": {
        "max_length": <int>,
        "min_length": <int>,
        "max_slope": <float>,
        "min_slope": <float>,
        "max_set_max_speed": <int>,
        "min_recommended_speed": <int>,
        "max_mean_speed": <float>,
        "min_mean_speed": <float>,
        "max_daily_year": <int>,
        "min_daily_year": <int>,
        "max_daily_july": <int>,
        "min_daily_july": <int>,
        "max_daily_trucks": <int>,
        "min_daily_trucks": <int>
    },
    "vehicle": {
        "id": <int>,
        "name": <string>,
        "data": {
            "top_speed": <float>,
            "milage": <float>,
            "max_fuel": <float>
        }
    },
    "nodes": {
        "<int>": {
            "id": <int>,
            "weight": <float>,
            "data": {
                "longitude": <float>,
                "latitude": <float>,
                "country": <string>,
                "municipality": <string>,
                "is_border": <bool>,
                "type": <string>,
                "signal_control": <bool>
            },
            "edges": {
                "<int>": {
                    "id": <int>,
                    "to_node_id": <int>,
                    "from_node_id" : <currentNode id>,
                    "weight": <float>,
                    "data": {
                        "length": <int>,
                        "slope": <float>,
                        "type": <string>,
                        "type_max_speed": <int>,
                        "set_max_speed": <int>,
                        "recommended_speed": <int>,
                        "mean_speed": <float>,
                        "daily_year": <int>,
                        "daily_july": <int>,
                        "daily_trucks": <int>,
                        "daily_10_axle": <float>,
                        "fuel_station": <bool>,
                        "max_axle_load": <float>,
                        "max_height": <float>,
                        "max_length": <float>,
                        "max_weight": <float>
                    }
                }
            }
        }
    }
}
```


## Endpoints
The microservice has three endpoints:
- [Status](#Status)
- [Route](#Route)
- [Info](#Info)


### Status
Request type **GET**

Path "/"

**Usage**
This endpoint returns a message if the service is running, and is only used for debugging.

The message is as follows:
```
The RouterViaFuelStations is online!
```


### Route
Request type **POST**

Path "/Route"

**Usage**
A request with the input JSON (as described earlier) is sent to the endpoint.

If the request is successful, a response with statuscode 200 and the TNM, which only contains the desired route, is returned.

If the request fails because of errors within the data, a response with statuscode 400 is returned alongside a message detailing what error occured.

### Info
Request type **GET**

Path "/Info"

**Usage**
Used to get information about the service.

The information is in the form of a redirect to the readme which is present on [GitLab](https://daisy-git.cs.aau.dk/astep-2021/tnmrouterviafuelstation2021/-/blob/master/README.md).
